;(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Run all of this when the document's ready
$(function(){

  // Load all of our UI elements here so that they're cached and super fast
  var metaform = $('#metaform'),
      wordEntry = $('#word-entry'),
      btnEntry = $('.btn-entry'),
      question = $('#question'),
      answer = $('#answer'),
      answerWord = $('#word'),
      answerMetaphor = $('#metaphor'),
      answerArticle = $('#article'),
      twitterShare = $('#twitter-share'),
      title = $('title');

  // Used later for history state changes
  var metaphorUrlRegex = /metaphor\/(.+)\/(.+)/;

  var showAnswer = function(word, metaphor){
    var metaphorSlug = metaphor.replace(/\s/g, '-'),
        wordSlug = word.replace(/\s/g, '-'),
        article = 'a';

    if(metaphor[0].match(/[aeiou]/)){
      article = 'an';
    }


    // Set the text
    answerWord.text(word);
    answerMetaphor.text(metaphor);
    answerArticle.text(article);

    title.text('Metaphorgy: My ' + word + ' is ' + article + ' ' + metaphor);

    twitterShare.attr('href',
      'http://twitter.com/intent/tweet?url=http://www.metaphor.gy/metaphor/' + wordSlug + '/' + metaphorSlug +
        '&text=My ' + word + ' is ' + article + ' ' + metaphor + '.&hashtags=metaphorgy');

    // Toggle all the classes, undisable the button, make mobile keyboards disappear
    btnEntry.addClass('btn-success3d').removeAttr('disabled');
    question.addClass('hidden');
    answer.removeClass('hidden');
    wordEntry.blur();
  }

  // Reset the hidden classes and whatnot
  var resetForm = function(){
    wordEntry.val('');
    btnEntry.removeClass('btn-success3d');
    question.removeClass('hidden');
    answer.addClass('hidden');

    title.text('Metaphorgy: Metaphor Generator');
  }

  // When the button is clicked, either submit the form or reset the state
  btnEntry.on('click', function(e){
    e.preventDefault();

    if(!btnEntry.attr('disabled')){
      if(btnEntry.hasClass('btn-success3d')){
        // Save it in the history so it looks like  a legit url
        if(history && history.pushState){
          history.pushState(null, null, '/');
        }

        // Reset the form, remove classes and whatnot
        resetForm();
      }else{
        // Otherwise, go ahead and submit the form
        metaform.submit();
      }
    }
  });

  // When the form is submitted, get the data
  metaform.on('submit', function(e){
    // Prevent the form from actually submitting; ajax instead
    e.preventDefault();

    var word = wordEntry.val().trim().replace(/\//, ' ');

    // Only continue if word isn't empty
    if(word != "" && word != "."){
      btnEntry.removeClass('btn-error3d');

      // Only do a thing if we're not waiting on a response
      if(!btnEntry.attr('disabled')){

        // Set the button to disabled while it loads
        btnEntry.attr('disabled', 'disabled');

        // Load the metaphor from the server
        $.getJSON('/metaphor/' + encodeURIComponent(word.replace(/\s/g, '-')), function(data){
          if(data.metaphor){
            var metaphorSlug = encodeURIComponent(data.metaphor.replace(/\s/g, '-')),
                wordSlug = encodeURIComponent(word.replace(/\s/g, '-'));

            // Save it in the history so it looks like  a legit url
            if(history && history.pushState){
              history.pushState(null, null, '/metaphor/' + wordSlug + '/' + metaphorSlug);
            }

            // Track the metaphor in google analytics, if available
            if(typeof ga != 'undefined' && ga){
              ga('send', 'event', 'metaphor', 'create', word);
            }

            // Show the answer in the fields
            showAnswer(data.word, data.metaphor);
          }else{
            btnEntry.addClass('btn-error3d').removeAttr('disabled');
          }
        });
      }
    }
  });

  var stateChange = function(path, fn){

  }

  var handleHistoryChange = function(e) {
    var regexResult = metaphorUrlRegex.exec(location.pathname);

    if(regexResult && regexResult.length == 3){
      var word = decodeURIComponent(regexResult[1]).replace(/-/g, ' '),
          metaphor = decodeURIComponent(regexResult[2]).replace(/-/g, ' ');

      showAnswer(word, metaphor);
    }else{
      resetForm();
    };
  }

  // When the history changes, load the metaphor or reset the form. Watch for
  // history changes.
  window.addEventListener("popstate", handleHistoryChange);
});


},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvVXNlcnMvYnJlYWtlcnMvU2l0ZXMvbWV0YXBob3JneS9zcmMvYXNzZXRzL2pzL2FwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBSdW4gYWxsIG9mIHRoaXMgd2hlbiB0aGUgZG9jdW1lbnQncyByZWFkeVxuJChmdW5jdGlvbigpe1xuXG4gIC8vIExvYWQgYWxsIG9mIG91ciBVSSBlbGVtZW50cyBoZXJlIHNvIHRoYXQgdGhleSdyZSBjYWNoZWQgYW5kIHN1cGVyIGZhc3RcbiAgdmFyIG1ldGFmb3JtID0gJCgnI21ldGFmb3JtJyksXG4gICAgICB3b3JkRW50cnkgPSAkKCcjd29yZC1lbnRyeScpLFxuICAgICAgYnRuRW50cnkgPSAkKCcuYnRuLWVudHJ5JyksXG4gICAgICBxdWVzdGlvbiA9ICQoJyNxdWVzdGlvbicpLFxuICAgICAgYW5zd2VyID0gJCgnI2Fuc3dlcicpLFxuICAgICAgYW5zd2VyV29yZCA9ICQoJyN3b3JkJyksXG4gICAgICBhbnN3ZXJNZXRhcGhvciA9ICQoJyNtZXRhcGhvcicpLFxuICAgICAgYW5zd2VyQXJ0aWNsZSA9ICQoJyNhcnRpY2xlJyksXG4gICAgICB0d2l0dGVyU2hhcmUgPSAkKCcjdHdpdHRlci1zaGFyZScpLFxuICAgICAgdGl0bGUgPSAkKCd0aXRsZScpO1xuXG4gIC8vIFVzZWQgbGF0ZXIgZm9yIGhpc3Rvcnkgc3RhdGUgY2hhbmdlc1xuICB2YXIgbWV0YXBob3JVcmxSZWdleCA9IC9tZXRhcGhvclxcLyguKylcXC8oLispLztcblxuICB2YXIgc2hvd0Fuc3dlciA9IGZ1bmN0aW9uKHdvcmQsIG1ldGFwaG9yKXtcbiAgICB2YXIgbWV0YXBob3JTbHVnID0gbWV0YXBob3IucmVwbGFjZSgvXFxzL2csICctJyksXG4gICAgICAgIHdvcmRTbHVnID0gd29yZC5yZXBsYWNlKC9cXHMvZywgJy0nKSxcbiAgICAgICAgYXJ0aWNsZSA9ICdhJztcblxuICAgIGlmKG1ldGFwaG9yWzBdLm1hdGNoKC9bYWVpb3VdLykpe1xuICAgICAgYXJ0aWNsZSA9ICdhbic7XG4gICAgfVxuXG5cbiAgICAvLyBTZXQgdGhlIHRleHRcbiAgICBhbnN3ZXJXb3JkLnRleHQod29yZCk7XG4gICAgYW5zd2VyTWV0YXBob3IudGV4dChtZXRhcGhvcik7XG4gICAgYW5zd2VyQXJ0aWNsZS50ZXh0KGFydGljbGUpO1xuXG4gICAgdGl0bGUudGV4dCgnTWV0YXBob3JneTogTXkgJyArIHdvcmQgKyAnIGlzICcgKyBhcnRpY2xlICsgJyAnICsgbWV0YXBob3IpO1xuXG4gICAgdHdpdHRlclNoYXJlLmF0dHIoJ2hyZWYnLFxuICAgICAgJ2h0dHA6Ly90d2l0dGVyLmNvbS9pbnRlbnQvdHdlZXQ/dXJsPWh0dHA6Ly93d3cubWV0YXBob3IuZ3kvbWV0YXBob3IvJyArIHdvcmRTbHVnICsgJy8nICsgbWV0YXBob3JTbHVnICtcbiAgICAgICAgJyZ0ZXh0PU15ICcgKyB3b3JkICsgJyBpcyAnICsgYXJ0aWNsZSArICcgJyArIG1ldGFwaG9yICsgJy4maGFzaHRhZ3M9bWV0YXBob3JneScpO1xuXG4gICAgLy8gVG9nZ2xlIGFsbCB0aGUgY2xhc3NlcywgdW5kaXNhYmxlIHRoZSBidXR0b24sIG1ha2UgbW9iaWxlIGtleWJvYXJkcyBkaXNhcHBlYXJcbiAgICBidG5FbnRyeS5hZGRDbGFzcygnYnRuLXN1Y2Nlc3MzZCcpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG4gICAgcXVlc3Rpb24uYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgIGFuc3dlci5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgd29yZEVudHJ5LmJsdXIoKTtcbiAgfVxuXG4gIC8vIFJlc2V0IHRoZSBoaWRkZW4gY2xhc3NlcyBhbmQgd2hhdG5vdFxuICB2YXIgcmVzZXRGb3JtID0gZnVuY3Rpb24oKXtcbiAgICB3b3JkRW50cnkudmFsKCcnKTtcbiAgICBidG5FbnRyeS5yZW1vdmVDbGFzcygnYnRuLXN1Y2Nlc3MzZCcpO1xuICAgIHF1ZXN0aW9uLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICBhbnN3ZXIuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgdGl0bGUudGV4dCgnTWV0YXBob3JneTogTWV0YXBob3IgR2VuZXJhdG9yJyk7XG4gIH1cblxuICAvLyBXaGVuIHRoZSBidXR0b24gaXMgY2xpY2tlZCwgZWl0aGVyIHN1Ym1pdCB0aGUgZm9ybSBvciByZXNldCB0aGUgc3RhdGVcbiAgYnRuRW50cnkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgaWYoIWJ0bkVudHJ5LmF0dHIoJ2Rpc2FibGVkJykpe1xuICAgICAgaWYoYnRuRW50cnkuaGFzQ2xhc3MoJ2J0bi1zdWNjZXNzM2QnKSl7XG4gICAgICAgIC8vIFNhdmUgaXQgaW4gdGhlIGhpc3Rvcnkgc28gaXQgbG9va3MgbGlrZSAgYSBsZWdpdCB1cmxcbiAgICAgICAgaWYoaGlzdG9yeSAmJiBoaXN0b3J5LnB1c2hTdGF0ZSl7XG4gICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgJy8nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlc2V0IHRoZSBmb3JtLCByZW1vdmUgY2xhc3NlcyBhbmQgd2hhdG5vdFxuICAgICAgICByZXNldEZvcm0oKTtcbiAgICAgIH1lbHNle1xuICAgICAgICAvLyBPdGhlcndpc2UsIGdvIGFoZWFkIGFuZCBzdWJtaXQgdGhlIGZvcm1cbiAgICAgICAgbWV0YWZvcm0uc3VibWl0KCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvLyBXaGVuIHRoZSBmb3JtIGlzIHN1Ym1pdHRlZCwgZ2V0IHRoZSBkYXRhXG4gIG1ldGFmb3JtLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihlKXtcbiAgICAvLyBQcmV2ZW50IHRoZSBmb3JtIGZyb20gYWN0dWFsbHkgc3VibWl0dGluZzsgYWpheCBpbnN0ZWFkXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgdmFyIHdvcmQgPSB3b3JkRW50cnkudmFsKCkudHJpbSgpLnJlcGxhY2UoL1xcLy8sICcgJyk7XG5cbiAgICAvLyBPbmx5IGNvbnRpbnVlIGlmIHdvcmQgaXNuJ3QgZW1wdHlcbiAgICBpZih3b3JkICE9IFwiXCIgJiYgd29yZCAhPSBcIi5cIil7XG4gICAgICBidG5FbnRyeS5yZW1vdmVDbGFzcygnYnRuLWVycm9yM2QnKTtcblxuICAgICAgLy8gT25seSBkbyBhIHRoaW5nIGlmIHdlJ3JlIG5vdCB3YWl0aW5nIG9uIGEgcmVzcG9uc2VcbiAgICAgIGlmKCFidG5FbnRyeS5hdHRyKCdkaXNhYmxlZCcpKXtcblxuICAgICAgICAvLyBTZXQgdGhlIGJ1dHRvbiB0byBkaXNhYmxlZCB3aGlsZSBpdCBsb2Fkc1xuICAgICAgICBidG5FbnRyeS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXG4gICAgICAgIC8vIExvYWQgdGhlIG1ldGFwaG9yIGZyb20gdGhlIHNlcnZlclxuICAgICAgICAkLmdldEpTT04oJy9tZXRhcGhvci8nICsgZW5jb2RlVVJJQ29tcG9uZW50KHdvcmQucmVwbGFjZSgvXFxzL2csICctJykpLCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICBpZihkYXRhLm1ldGFwaG9yKXtcbiAgICAgICAgICAgIHZhciBtZXRhcGhvclNsdWcgPSBlbmNvZGVVUklDb21wb25lbnQoZGF0YS5tZXRhcGhvci5yZXBsYWNlKC9cXHMvZywgJy0nKSksXG4gICAgICAgICAgICAgICAgd29yZFNsdWcgPSBlbmNvZGVVUklDb21wb25lbnQod29yZC5yZXBsYWNlKC9cXHMvZywgJy0nKSk7XG5cbiAgICAgICAgICAgIC8vIFNhdmUgaXQgaW4gdGhlIGhpc3Rvcnkgc28gaXQgbG9va3MgbGlrZSAgYSBsZWdpdCB1cmxcbiAgICAgICAgICAgIGlmKGhpc3RvcnkgJiYgaGlzdG9yeS5wdXNoU3RhdGUpe1xuICAgICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCAnL21ldGFwaG9yLycgKyB3b3JkU2x1ZyArICcvJyArIG1ldGFwaG9yU2x1Zyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRyYWNrIHRoZSBtZXRhcGhvciBpbiBnb29nbGUgYW5hbHl0aWNzLCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgIGlmKHR5cGVvZiBnYSAhPSAndW5kZWZpbmVkJyAmJiBnYSl7XG4gICAgICAgICAgICAgIGdhKCdzZW5kJywgJ2V2ZW50JywgJ21ldGFwaG9yJywgJ2NyZWF0ZScsIHdvcmQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTaG93IHRoZSBhbnN3ZXIgaW4gdGhlIGZpZWxkc1xuICAgICAgICAgICAgc2hvd0Fuc3dlcihkYXRhLndvcmQsIGRhdGEubWV0YXBob3IpO1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgYnRuRW50cnkuYWRkQ2xhc3MoJ2J0bi1lcnJvcjNkJykucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdmFyIHN0YXRlQ2hhbmdlID0gZnVuY3Rpb24ocGF0aCwgZm4pe1xuXG4gIH1cblxuICB2YXIgaGFuZGxlSGlzdG9yeUNoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgcmVnZXhSZXN1bHQgPSBtZXRhcGhvclVybFJlZ2V4LmV4ZWMobG9jYXRpb24ucGF0aG5hbWUpO1xuXG4gICAgaWYocmVnZXhSZXN1bHQgJiYgcmVnZXhSZXN1bHQubGVuZ3RoID09IDMpe1xuICAgICAgdmFyIHdvcmQgPSBkZWNvZGVVUklDb21wb25lbnQocmVnZXhSZXN1bHRbMV0pLnJlcGxhY2UoLy0vZywgJyAnKSxcbiAgICAgICAgICBtZXRhcGhvciA9IGRlY29kZVVSSUNvbXBvbmVudChyZWdleFJlc3VsdFsyXSkucmVwbGFjZSgvLS9nLCAnICcpO1xuXG4gICAgICBzaG93QW5zd2VyKHdvcmQsIG1ldGFwaG9yKTtcbiAgICB9ZWxzZXtcbiAgICAgIHJlc2V0Rm9ybSgpO1xuICAgIH07XG4gIH1cblxuICAvLyBXaGVuIHRoZSBoaXN0b3J5IGNoYW5nZXMsIGxvYWQgdGhlIG1ldGFwaG9yIG9yIHJlc2V0IHRoZSBmb3JtLiBXYXRjaCBmb3JcbiAgLy8gaGlzdG9yeSBjaGFuZ2VzLlxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIGhhbmRsZUhpc3RvcnlDaGFuZ2UpO1xufSk7XG5cbiJdfQ==
;